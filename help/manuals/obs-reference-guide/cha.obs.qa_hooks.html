<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 17. Quality Assurance(QA) Hooks</title><link rel="stylesheet" type="text/css" href="static/css/susebooks.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="self" href="cha.obs.qa_hooks.html" title="Quality Assurance(QA) Hooks" /><link rel="home" href="index.html" title="Open Build Service" /><link rel="up" href="index.html" title="Open Build Service" /><link rel="previous" href="cha.obs.authorization.token.html" title="Chapter 16. Authorization" /><link rel="next" href="cha.obs.factory.html" title="Chapter 18. openSUSE Factory" /></head><body><div class="navheader"><table width="100%" summary="Navigation header" border="0" class="bctable"><tr><td width="80%"><div class="breadcrumbs"><p><a href="index.html">Open Build Service</a><strong><a accesskey="p" title="Chapter 16. Authorization" href="cha.obs.authorization.token.html"><span>◀</span></a>  <a accesskey="n" title="Chapter 18. openSUSE Factory" href="cha.obs.factory.html"><span>▶</span></a></strong></p></div></td></tr></table></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="cha.obs.qa_hooks"></a>Chapter 17. Quality Assurance(QA) Hooks<span class="permalink"><a title="Copy Permalink" href="#cha.obs.qa_hooks">¶</a></span></h2></div></div></div><div class="toc"><p><strong>Contents</strong></p><dl class="toc"><dt><span class="section"><a href="cha.obs.qa_hooks.html#idm139841170575456">17.1. Source related checks</a></span></dt><dt><span class="section"><a href="cha.obs.qa_hooks.html#idm139841167884176">17.2. Build time check</a></span></dt><dt><span class="section"><a href="cha.obs.qa_hooks.html#idm139841168793296">17.3. Work-flow checks</a></span></dt></dl></div><p>OBS provides multiple hooks to place automated or manual tests at different points of time.</p><p>This chapter describes the different possibilities to provide and executre QA checks. The
        order of the items is sorted by the order in a typical development process. It is prefered to 
        add a check as early as possible in the process to keep turn-around times small.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm139841170575456"></a>17.1. Source related checks<span class="permalink"><a title="Copy Permalink" href="#idm139841170575456">¶</a></span></h2></div></div></div><p>Things which can be verified based on a given source can be checked even before commit time on
          the developers workstation. This is the earliest possible point of time to add a check. But it
          can also optionaly be enforced on the server side.
          </p><p>Automated source processing is done by source services in OBS world. Please check the source
          service chapter how to use or write one. It is important to decide if the test case shall output
          warning messages and when it shall report an error by exit status.
          </p><p>Test cases in source services get usually applied to all packages of a project. (It is possible to execute it only for specific packages though.)</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm139841167884176"></a>17.2. Build time check<span class="permalink"><a title="Copy Permalink" href="#idm139841167884176">¶</a></span></h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139841169101904"></a>17.2.1. In-package checks<span class="permalink"><a title="Copy Permalink" href="#idm139841169101904">¶</a></span></h3></div></div></div><p>Checks running during the build of a package are usually test cases provided by the author of
            a package. However, also the packager might add simple checks, esp. for stuff which is known
            to break on version updates for example and might be forgotten when the package gets touched
            the next time.</p><p>These test are often specific for a concrete package only. So it is typically executed in %check
            section of rpm spec files directly. In case the check can be used with multiple package source,
            it is a good idea to package the test case in an own package and just call it from the other
            packages.
      </p><p>rpm calls %check after %install section and before creating the actual checks.</p><p>SUSE distros is also providing build time checks for testing the installed files inside of the
            build root. It is to be used for test cases which shall run on all packages which are build inside
            of a distribuition. This hook can be used by installing a file to /usr/lib/rpm/brp-suse.d/ directory.
            These scripts have also the power to modify the installed files if needed.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139841168903216"></a>17.2.2. Post build checks<span class="permalink"><a title="Copy Permalink" href="#idm139841168903216">¶</a></span></h3></div></div></div><p>The standard to test built package binaries is rpmlint for rpm based distros. Debian distributions
            are using the lintian tool.</p><p>These checks are executed by the build script after the a successful build happened. Please note
            that these are executed as standard user by default.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139841172498928"></a>17.2.3. Post build root checks<span class="permalink"><a title="Copy Permalink" href="#idm139841172498928">¶</a></span></h3></div></div></div><p>Files in /usr/lib/build/checks/* are executed as root user. Typical uscases are install tests
            of the build packages to ensure that the scripts inside of the packages are working in general.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139841168219856"></a>17.2.4. KIWI specific post build root checks<span class="permalink"><a title="Copy Permalink" href="#idm139841168219856">¶</a></span></h3></div></div></div><p>The file /usr/lib/build/kiwi_post_run is executed after kiwi jobs have finished. It can be used
            to run the appliance or to modify it. For example to package an appliance into a rpm.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm139841168793296"></a>17.3. Work-flow checks<span class="permalink"><a title="Copy Permalink" href="#idm139841168793296">¶</a></span></h2></div></div></div><p>Work flow steps, for example transfering packages from one project to another, are done via requests in OBS. At least when multiple parties are involved. One or more of these parties can be automated test cases. Or human manual approval steps.</p><p>Default reviews can be defined inside of projects and packages. A new request to a certain package does get the reviewers added defined in target projects and packages. Reviewers can be currently users, groups or the maintainers of a specified project or package.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139841171817728"></a>17.3.1. Automated test cases<span class="permalink"><a title="Copy Permalink" href="#idm139841171817728">¶</a></span></h3></div></div></div><p>Open requests can be requested in an xml parseable way via the api running</p><pre class="screen"><span class="command"><strong>osc api /request?states=review&amp;user=auto-review-user&amp;roles=reviewer&amp;reviewstates=new&amp;view=collection</strong></span></pre><p>osc can also be used to accept or decline the reviews of these requests after running the automated test. Also a comment can be given to show errors which appeared. It is important that requests, which are not  tested, for example because they are of a not matching type (eg. deleting packages) needs to get also a review accept. Otherwise the process would get blocked.</p></div></div></div><div class="navfooter"><table width="100%" summary="Navigation footer" border="0" class="bctable"><tr><td width="80%"><div class="breadcrumbs"><p><a href="index.html">Open Build Service</a><strong><a accesskey="p" title="Chapter 16. Authorization" href="cha.obs.authorization.token.html"><span>◀</span></a>  <a accesskey="n" title="Chapter 18. openSUSE Factory" href="cha.obs.factory.html"><span>▶</span></a></strong></p></div></td></tr></table></div></body></html>