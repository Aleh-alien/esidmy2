<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 7. Build Configuration</title><link rel="stylesheet" type="text/css" href="static/css/susebooks.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="self" href="cha.obs.build_config.html" title="Build Configuration" /><link rel="home" href="index.html" title="Open Build Service" /><link rel="up" href="index.html" title="Open Build Service" /><link rel="previous" href="cha.obs.package_formats.html" title="Chapter 6. Package Formats" /><link rel="next" href="cha.obs.source_service.html" title="Chapter 8. Source Services" /></head><body><div class="navheader"><table width="100%" summary="Navigation header" border="0" class="bctable"><tr><td width="80%"><div class="breadcrumbs"><p><a href="index.html">Open Build Service</a><strong><a accesskey="p" title="Chapter 6. Package Formats " href="cha.obs.package_formats.html"><span>◀</span></a>  <a accesskey="n" title="Chapter 8. Source Services" href="cha.obs.source_service.html"><span>▶</span></a></strong></p></div></td></tr></table></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="cha.obs.build_config"></a>Chapter 7. Build Configuration<span class="permalink"><a title="Copy Permalink" href="#cha.obs.build_config">¶</a></span></h2></div></div></div><div class="toc"><p><strong>Contents</strong></p><dl class="toc"><dt><span class="section"><a href="cha.obs.build_config.html#idm140625645671696">7.1. Configuration File Syntax</a></span></dt><dt><span class="section"><a href="cha.obs.build_config.html#idm140625647097776">7.2. Macro Section</a></span></dt></dl></div><p>The build configuration is needed at least in each base project to define the
        setup of the build system. In addition to that it can be used to handle compatibility
        layers or to switch on or off certain features during the build.</p><p>The build config is reachable via API /source/PROJECT/_config, via <span class="command"><strong>osc meta prjconf</strong></span>
        or via webui via Project Config tab.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm140625645671696"></a>7.1. Configuration File Syntax<span class="permalink"><a title="Copy Permalink" href="#idm140625645671696">¶</a></span></h2></div></div></div><p>The build configuration is parsed by OBS in rpm style independend of the used packaging
          format. This means that you can use rpm features like macros or conditions in the configuration.
          All lines consist of the form 'keyword: arguments'.
    </p><p>
      &lt;PACKAGES&gt; mean binary package provides, but not the full filename. For example gcc, but not gcc-1.2.3.i386.rpm. Provides of a package can not be used either.
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625643924624"></a>7.1.1. Required: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625643924624">¶</a></span></h3></div></div></div><p>Required lines contain one or more packages that always get installed for package builds.
            A change in one of the requires packages triggers a new build.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625643829232"></a>7.1.2. Support: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625643829232">¶</a></span></h3></div></div></div><p>Support lines contain one or more packages which also get installed for package builds, but
            a change in one of the packages does not trigger an automatic rebuild. This is useful
            for packages that most likely do not influence the build result, for example 'make',
            or 'coreutils'.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625645565888"></a>7.1.3. Preinstall: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625645565888">¶</a></span></h3></div></div></div><p>Preinstall packages are needed to run the package installation program. They get unpacked before
            the VM gets started. Included scripts are NOT executed during this phase. However these
            packages will get installed again inside of the VM including script execution.  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625646152832"></a>7.1.4. Keep: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625646152832">¶</a></span></h3></div></div></div><p>To elimiate build cycles the to-be-built package is not installed by default, even when it is
            required. Keep can be used overwrite this behaviour. It is usually needed for packages like
            'make' that are used to build itself. Preinstalled packages are automatically kept, as
            the package installation program needs to work all the time.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625643613696"></a>7.1.5. VMInstall: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625643613696">¶</a></span></h3></div></div></div><p>VMInstall is like Preinstall, but these packages get only installed when a virtual machine
            like XEN or KVM is used for building. Usually packages like 'mount' are listed here.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625642648976"></a>7.1.6. Runscripts: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625642648976">¶</a></span></h3></div></div></div><p>Runscripts defines the scripts of preinstalled packages which needs to be executed directly after
            the preinstall phase, before installing the remaining packages.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625646896800"></a>7.1.7. Order: &lt;PACKAGE_A&gt;:&lt;PACKAGE_B&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625646896800">¶</a></span></h3></div></div></div><p>The build script takes care about the installation order if they are defined via dependencies
            inside of the packages. However, there might be dependency loops (reported during setup of the
            build system) or missing dependencies. The Order statement can be used then to give a hint where
            to break the loop. &lt;PACKAGE_A&gt; will get installed before &lt;PACKAGE_B&gt;.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625642420640"></a>7.1.8. ExportFilter: &lt;REGEXP&gt; &lt;ARCHITECTURES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625642420640">¶</a></span></h3></div></div></div><p>The export filter can be used to export build results from one architecture to others. This is 
            required when one architecture needs packages from another architector for building.
            The regexp must match the resulting binary name of the package. It will export it to all listed
            scheduler architectures. Using a single dot will export it to the architecture which was used
            to build it. So not using a dot there will filter the package.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625645858320"></a>7.1.9. Prefer: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625645858320">¶</a></span></h3></div></div></div><p>In case multiple packages satisfy a dependency, the OBS system will complain about that situation.
            This is unlike like most package managing tools, which just pick one of the package. Because
            one of OBS' goal is to provide reproducible builds, it reports an error in this case instead
            of chosing a random package. The Prefer: tag lists packages to be prefered in case a choice
            exists. When the package name is prefixed with a dash, this is treated as a de-prefer.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625645547200"></a>7.1.10. Prefer: &lt;PACKAGE_A&gt;:&lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625645547200">¶</a></span></h3></div></div></div><p>It is possible to define the prefer only when one package is creating the choice error.
            This package must be listed first with a colon.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625645545616"></a>7.1.11. Ignore: &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625645545616">¶</a></span></h3></div></div></div><p>Ignore can be used to break dependencies. This can be usefull to reduce the number of needed
            packages or to break cyclic dependencies. Be careful with this feature, as breaking
            dependencies can have surprising results.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625645543904"></a>7.1.12. Ignore: &lt;PACKAGE_A&gt;:&lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625645543904">¶</a></span></h3></div></div></div><p>It is possible to define the ignore only for one package. This package must be listed first
            with a colon.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625645542432"></a>7.1.13. FileProvides: &lt;FILE&gt; &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625645542432">¶</a></span></h3></div></div></div><p>OBS ignores dependendencies to files (instead of package names) by default. This is mostly
            done to reduce the amount of memory needed, as the package file lists take up a
            considerable amount of repository meta data. As a workaround, FileProvides can be used to
            tell the systems which packages contain a file. The File needs to have the full path.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625646566224"></a>7.1.14. Substitute: &lt;PACKAGE_A&gt; &lt;PACKAGES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625646566224">¶</a></span></h3></div></div></div><p>It is possible to replace to BuildRequires with other packages. This will have only an affect
            on directly BuildRequired packages, not on indirectly required packages.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625646564560"></a>7.1.15. BuildFlags: &lt;FLAG&gt;:&lt;VALUE&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625646564560">¶</a></span></h3></div></div></div><p>This defines flags for the build process. The only currently supported flag is the vmfstype flag,
            which can be used to define a specific filesystem when building inside of a VM.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625646562880"></a>7.1.16. OptFlags: &lt;TARGET_ARCHITECTURE&gt; &lt;FLAGS&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625646562880">¶</a></span></h3></div></div></div><p>rpm only: Optflags exports compiler flags to the build. They will only have an effect when the
            spec file is using $RPM_OPT_FLAGS. The target architecture may be * to affect all architectures.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625646561232"></a>7.1.17. Target: &lt;TARGET_ARCHITECTURE&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625646561232">¶</a></span></h3></div></div></div><p>rpm only: Defines the target architecture. This can be used to build for i686 on i586 schedulers
            for example.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625646559616"></a>7.1.18. HostArch: &lt;HOST_ARCHITECTURE&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625646559616">¶</a></span></h3></div></div></div><p>This is used for cross builds. It defines the host architecture used for building, while the
            scheduler architecture remains the target architecture.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625643572848"></a>7.1.19. type: &lt;TYPE&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625643572848">¶</a></span></h3></div></div></div><p>Defines the recipe format. Valid values are currently: none, spec, dsc, arch, kiwi,
            preinstallimage. If no type is specified, OBS deduces a type from the binary type.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625643571200"></a>7.1.20. Binarytype: &lt;TYPE&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625643571200">¶</a></span></h3></div></div></div><p>(OBS 2.4 or later): Sets the binary format used to setup the build environment. For example a
            package with spec build description may use and generate deb packages instead of rpms.
            If no binary type is specifed, OBS deduces it from the recipe type. If the recipe type is
            also not set, OBS looks at the Preinstall package list for a hint.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625643569360"></a>7.1.21. Repotype: &lt;TYPE[:OPTIONS]&gt; ...<span class="permalink"><a title="Copy Permalink" href="#idm140625643569360">¶</a></span></h3></div></div></div><p>Defines the repository format for pulished repositories. Valid values are: none, rpm-md,
            suse, debian, hdlist2, arch, staticlinks. The OPTIONS parameter depends on the repository type,
            for rpm-md the known options are 'legacy' to create the old rpm-md format, 'deltainfo' or
            'prestodelta' to create delta rpm packages, 'rsyncable' to use rsyncable gzip compression.
            To split the debug packages in an own published repository the option
            splitdebug:$REPOSIORY_SUFFIX can be used.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625643567328"></a>7.1.22. Patterntype: &lt;TYPES&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625643567328">¶</a></span></h3></div></div></div><p>Defines the pattern format. Valid values are: none (default), ymp, comps.  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140625647099632"></a>7.1.23. Constraint: &lt;SELECTOR&gt; &lt;STRING&gt;<span class="permalink"><a title="Copy Permalink" href="#idm140625647099632">¶</a></span></h3></div></div></div><p>(OBS 2.4 or later): Define build constraints for build jobs. The selector is a colon seperated
            list which gets a string assigned. Please see the build job constraints page for details.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm140625647097776"></a>7.2. Macro Section<span class="permalink"><a title="Copy Permalink" href="#idm140625647097776">¶</a></span></h2></div></div></div><p>The macro section of the build configuration starts behind a Macros: line and is only used on rpm builds. The content
          gets exported to be used by rpmbuild during the build. It can be used to export a define using "%key value" lines.</p></div></div><div class="navfooter"><table width="100%" summary="Navigation footer" border="0" class="bctable"><tr><td width="80%"><div class="breadcrumbs"><p><a href="index.html">Open Build Service</a><strong><a accesskey="p" title="Chapter 6. Package Formats " href="cha.obs.package_formats.html"><span>◀</span></a>  <a accesskey="n" title="Chapter 8. Source Services" href="cha.obs.source_service.html"><span>▶</span></a></strong></p></div></td></tr></table></div></body></html>